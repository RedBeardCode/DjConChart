{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}

    {% for plot, recalc_needed, num_of_invalid in content_values %}
        {% autoescape off %}
            {{ plot }}
        {% endautoescape %}

        {% if recalc_needed %}
            <div id="recalc_{{ forloop.counter0 }}">
                <div class="alert alert-warning" role="alert">
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                    <span class="sr-only">Warning:</span>
                    There are to many invalid characteristic values. Please start the recalculation manually.
                </div>
                <div style="width: 100%; text-align: center;display: flex">

                    <button style=" display: inline-block; margin-right: 20px" type="button" id="recalc_values"
                            class="btn btn-default" onclick="recalc_values_{{ forloop.counter0 }}()">Recalculation of
                        invalid
                        values
                    </button>
                    <div class="progress"
                         style="display: inline-block;width: 100%; margin-top: 7px;margin-bottom: 0px;">
                        <div class="progress-bar" id="progress-bar_{{ forloop.counter0 }}" role="progressbar"
                             aria-valuenow="0" aria-valuemin="0"
                             aria-valuemax="{{ num_of_invalid }}" style="width: 0%;">
                            <span id="progress_value_{{ forloop.counter0 }}"> 0% </span>
                        </div>
                    </div>

                </div>
            </div>
        {% endif %}

    {% endfor %}

{% endblock %}
    {% block inlinescripts %}
        <script type="text/javascript">
            $(document).ready(function () {
                init_ajax_csrf();
            });
            {% for recalc_needed, filter_args, num_of_invalid in script_values %}
                function after_finished_{{ forloop.counter0 }}() {
                    $("#recalc_{{ forloop.counter0 }}").remove();
                }

                {% include "recalc_js_snippet.html" %}
            {% endfor %}
        </script>
    {% endblock %}

