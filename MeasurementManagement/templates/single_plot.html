{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}
    {% autoescape off %}
        {{ script }}
    {% endautoescape %}
    {% if recalc_needed %}
        <div id="recalc">
            <div class="alert alert-warning" role="alert">
                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                <span class="sr-only">Warning:</span>
                There are to many invalid characteristic values. Please start the recalculation manually.
            </div>
            <div style="width: 100%; text-align: center;display: flex">

                <button style=" display: inline-block; margin-right: 20px" type="button" id="recalc_values"
                        class="btn btn-default" onclick="recalc_values()">Recalculation of invalid
                    values
                </button>
                <div class="progress" style="display: inline-block;width: 100%; margin-top: 7px;margin-bottom: 0px;">
                    <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0"
                         aria-valuemax="{{ num_of_invalid }}" style="width: 0%;">
                        <span id="progress_value"> 0%</span>
                    </div>
                </div>

            </div>
        </div>

    {% endif %}

{% endblock %}
{% if recalc_needed %}
    {% block inlinescripts %}
        <script type="text/javascript">
            $(document).ready(function () {
                init_ajax_csrf();
            });
            function after_finished() {
                $("#recalc").remove();
            }
            {% include "recalc_js_snippet.html" %}
        </script>
    {% endblock %}
{% endif %}

